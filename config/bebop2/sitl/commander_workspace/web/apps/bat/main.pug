extends ../../../web_includes/common/layout

block includes
  include ../../../web_includes/common/common_includes.pug

block header
        i.fa-fw.fa.fa-signal
        | Battery

block main
  .row.row-fluid
    article.col-xs-10.col-sm-8.col-md-6.col-lg-6(style='max-width:450px')
        #wid-BAT-CmdAndData.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false')
          header
            span.widget-icon
              i.fa.fa-table
            h2 Housekeeping
          div
            .jarviswidget-editbox
              input.form-control(type='text')
            .widget-body
              .table-responsive
                table.table.table-condensed
                  tbody
                    tr
                      th Cmd Count
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/CmdCounter'}]}) ---
                    tr
                      th Error Count
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/ErrCounter'}]}) ---
              footer
                button.btn.btn-primary(data-sage={cmd: {name:'/CFS/BAT/NoOp'}}) No-Op
                button.btn.btn-primary(data-sage={cmd: {name:'/CFS/BAT/Reset'}}) Reset
    
    script.
        function FloatToPercent(item) {
            //return Number((item * 100).toFixed(0));
            return item * 100;
        }
        
                    
    article.col-xs-10.col-sm-8.col-md-6.col-lg-6(style='max-width:450px')
        #wid-BAT-BatteryStatus.jarviswidget.jarviswidget-color-blueDark(data-widget-editbutton='false')
          header
            span.widget-icon
              i.fa.fa-table
            h2 Battery Status
          div
            .jarviswidget-editbox
              input.form-control(type='text')
            .widget-body
              .table-responsive
                table.table.table-condensed
                  tbody
                    tr
                      th Timestamp
                      td
                        span.format-microseconds(data-sage={tlm: [{name:'/CFS/BAT/Timestamp'}]}) ---
                    tr
                      th Voltage
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/Voltage'}]}) ---
                    tr
                      th Voltage (filtered)
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/VoltageFiltered'}]}) ---
                    tr
                      th Current
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/Current'}]}) ---
                    tr
                      th Current (filtered)
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/CurrentFiltered'}]}) ---
                    tr
                      th Discharged
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/Discharged'}]}) ---
                    tr
                      th Remaining
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/Remaining', format:'%.0f%%', calibration:{type:'function', function:'FloatToPercent(value)'}}]}) ---
                    tr
                      th Scale
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/Scale'}]}) ---
                    tr
                      th Cell Count
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/CellCount'}]}) ---
                    tr
                      th Connected
                      td
                        div.bool-led(data-sage={tlm: [{name:'/CFS/BAT/Connected'}]})
                    tr
                      th Warning
                      td
                        span(data-sage={tlm: [{name:'/CFS/BAT/Warning'}]}) ---
                                        
  .row
    +app_specific_telemetry_control("BAT")
                                              
  .row          
    +app_specific_mempools("BAT")
    
  .row
    +app_specific_application_control("BAT") 
    +registered_applications() 
  
  .row
    +app_specific_table_control("BAT")
    
  .row
    +app_specific_scheduler_control("BAT")

